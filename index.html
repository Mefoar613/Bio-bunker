<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Bio-Bunker Clicker</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            color: #fff;
            font-family: 'Verdana', sans-serif;
            overflow: hidden;
            touch-action: none; 
            user-select: none;
        }

        /* --- –ó–ê–ì–†–£–ó–ß–ò–ö (–û—Å—Ç–∞–≤–ª—è–µ–º, –æ–Ω –∫—Ä—É—Ç–æ–π) --- */
        #loader {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 9999; display: flex; align-items: center; justify-content: center;
            background: #000; transition: opacity 0.5s;
        }
        .door-panel {
            position: absolute; top: 0; width: 50%; height: 100%;
            background: url('https://i.postimg.cc/RZRVdSN2/1766590760938.jpg') no-repeat center center;
            background-size: cover; z-index: 2; transition: transform 0.8s ease-in-out;
        }
        #door-left { left: 0; border-right: 2px solid #111; }
        #door-right { right: 0; border-left: 2px solid #111; }
        .open #door-left { transform: translateX(-100%); }
        .open #door-right { transform: translateX(100%); }
        #rad-icon {
            position: absolute; z-index: 3; width: 150px; height: 150px;
            background: url('https://i.postimg.cc/VLX6hy7r/1000054477.png') no-repeat center center;
            background-size: contain; filter: drop-shadow(0 0 15px #0f0);
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse { 50% { transform: scale(1.1); } }

        /* --- –ú–ï–ù–Æ (–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ö–ù–û–ü–û–ö) --- */
        #screen-menu {
            /* ?v=8 –¥–ª—è —Å–±—Ä–æ—Å–∞ –∫—ç—à–∞ */
            background: url('https://i.postimg.cc/JnyrRjP7/1766591867996.png?v=8') no-repeat center bottom;
            background-size: cover;
            display: flex; flex-direction: column; justify-content: flex-end; align-items: center;
            padding-bottom: 80px; height: 100vh;
        }

        .menu-buttons {
            display: flex; flex-direction: column; gap: 15px; width: 100%; align-items: center;
        }

        .menu-btn {
            /* –ñ–ï–°–¢–ö–ò–ï –†–ê–ó–ú–ï–†–´ */
            width: 320px; 
            height: 90px; 
            
            /* –†–∞—Å—Ç—è–≥–∏–≤–∞–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É –Ω–∞ –≤–µ—Å—å –±–ª–æ–∫ (fix —É—Ä–æ–¥—Å—Ç–≤–∞) */
            background: url('https://i.postimg.cc/C1WhvJkb/1000054476.png?v=8') no-repeat center center;
            background-size: 100% 100%; 
            
            display: flex; align-items: center; justify-content: center;
            color: #d0ffd0; font-size: 24px; font-weight: 900;
            text-transform: uppercase; text-shadow: 0 3px 5px #000;
            cursor: pointer; padding-bottom: 5px;
            filter: drop-shadow(0 5px 5px rgba(0,0,0,0.5));
        }
        .menu-btn:active { transform: scale(0.95); filter: brightness(1.2); }

        /* --- –ò–ì–†–û–í–û–ï –ü–û–õ–ï (–ö–õ–ò–ö–ï–†) --- */
        .screen { display: none; width: 100vw; height: 100vh; position: absolute; top: 0; left: 0; }
        .active { display: flex; }
        
        #screen-game { 
            background: #1a1a1a; /* –°—é–¥–∞ –ø–æ—Ç–æ–º –≤—Å—Ç–∞–≤–∏–º —Ç–≤–æ–π –Ω–æ–≤—ã–π —Ñ–æ–Ω */
            background-size: cover; background-position: center;
            overflow: hidden; position: relative;
        }
        
        #hud {
            position: absolute; top: 20px; width: 100%; text-align: center;
            color: #0f0; font-size: 24px; font-weight: bold; text-shadow: 0 0 10px #000;
            z-index: 10; pointer-events: none;
            background: rgba(0,0,0,0.5); padding: 10px 0;
        }

        /* –ö–†–ò–°–¢–ê–õ–õ–´ */
        .crystal {
            position: absolute;
            font-size: 60px; /* –†–∞–∑–º–µ—Ä —ç–º–æ–¥–∑–∏ –ø–æ–∫–∞ */
            cursor: pointer;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            filter: drop-shadow(0 0 10px #0f0);
            transition: transform 0.1s;
        }
        .crystal:active { transform: scale(0.9); }
        @keyframes popIn { from { transform: scale(0); } to { transform: scale(1); } }
        @keyframes fadeOut { from { opacity: 1; transform: scale(1); } to { opacity: 0; transform: scale(2); } }

        /* –≠—Ñ—Ñ–µ–∫—Ç +1 */
        .floater {
            position: absolute; color: #fff; font-weight: bold; font-size: 24px;
            pointer-events: none; animation: floatUp 1s forwards; text-shadow: 0 0 5px #0f0;
        }
        @keyframes floatUp { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(-50px); opacity: 0; } }

    </style>
</head>
<body>

    <div id="loader" onclick="this.style.display='none'">
        <div id="door-left" class="door-panel"></div>
        <div id="door-right" class="door-panel"></div>
        <div id="rad-icon"></div>
    </div>

    <div id="screen-menu" class="screen active">
        <div class="menu-buttons">
            <div class="menu-btn" onclick="startGame()">–ù–û–í–ê–Ø –ò–ì–†–ê</div>
            <div class="menu-btn" onclick="alert('–ú–∞–≥–∞–∑–∏–Ω —Å–∫–æ—Ä–æ...')">–ú–ê–ì–ê–ó–ò–ù</div>
        </div>
    </div>

    <div id="screen-game" class="screen">
        <div id="hud">–ë–ò–û-–†–ï–°–£–†–°: <span id="score">0</span></div>
        <div id="game-area"></div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        // –ó–∞–≥—Ä—É–∑–∫–∞
        setTimeout(() => {
            const loader = document.getElementById('loader');
            if(loader) {
                loader.classList.add('open');
                setTimeout(() => loader.style.display = 'none', 1000);
            }
        }, 2000);

        // –ó–≤—É–∫ (–ø—Ä–æ—Å—Ç–æ–π —Å–∏–Ω—Ç–µ–∑)
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playClickSound() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.frequency.setValueAtTime(800, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
            osc.start(); osc.stop(audioCtx.currentTime + 0.1);
        }

        // --- –õ–û–ì–ò–ö–ê –ö–õ–ò–ö–ï–†–ê ---
        let score = 0;
        let gameActive = false;
        let spawnTimer;

        function startGame() {
            document.getElementById('screen-menu').classList.remove('active');
            document.getElementById('screen-game').classList.add('active');
            gameActive = true;
            score = 0;
            document.getElementById('score').innerText = score;
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ü–∏–∫–ª —Å–ø–∞–≤–Ω–∞ (–¢–∞–π–º–µ—Ä 5 —Å–µ–∫? –°–¥–µ–ª–∞–µ–º –ø–æ–∫–∞ —Å–ø–∞–≤–Ω –∫–∞–∂–¥—ã–µ 0.8 —Å–µ–∫, –∞ –∂–∏–≤—É—Ç –æ–Ω–∏ 5 —Å–µ–∫)
            spawnCycle();
        }

        function spawnCycle() {
            if(!gameActive) return;
            spawnCrystal();
            // –°–ª—É—á–∞–π–Ω–æ–µ –≤—Ä–µ–º—è –ø–æ—è–≤–ª–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ (–æ—Ç 0.5 –¥–æ 1.5 —Å–µ–∫)
            setTimeout(spawnCycle, 500 + Math.random() * 1000);
        }

        function spawnCrystal() {
            const area = document.getElementById('screen-game');
            const el = document.createElement('div');
            el.className = 'crystal';
            el.innerText = 'üíé'; // –ü–û–ö–ê –≠–ú–û–î–ó–ò, –ü–û–¢–û–ú –ö–ê–†–¢–ò–ù–ö–ê
            
            // –°–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è (–æ—Ç—Å—Ç—É–ø–∞–µ–º –æ—Ç –∫—Ä–∞–µ–≤)
            const x = Math.random() * (window.innerWidth - 80) + 10;
            const y = Math.random() * (window.innerHeight - 150) + 60; // –û—Ç—Å—Ç—É–ø —Å–≤–µ—Ä—Ö—É –ø–æ–¥ HUD
            
            el.style.left = x + 'px';
            el.style.top = y + 'px';

            // –ö–ª–∏–∫ –ø–æ –∫—Ä–∏—Å—Ç–∞–ª–ª—É
            el.onpointerdown = (e) => {
                e.stopPropagation(); // –ß—Ç–æ–±—ã –Ω–µ –∫–ª–∏–∫–∞—Ç—å —Å–∫–≤–æ–∑—å
                collectCrystal(el, x, y);
            };

            area.appendChild(el);

            // –¢–∞–π–º–µ—Ä –∂–∏–∑–Ω–∏ (–∏—Å—á–µ–∑–∞–µ—Ç —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥, –µ—Å–ª–∏ –Ω–µ –Ω–∞–∂–∞—Ç—å)
            setTimeout(() => {
                if(el.parentNode) {
                    el.style.opacity = '0.5'; // –¢—É—Å–∫–Ω–µ–µ—Ç
                    setTimeout(() => { if(el.parentNode) el.remove(); }, 500);
                }
            }, 4000); 
        }

        function collectCrystal(el, x, y) {
            playClickSound();
            tg.HapticFeedback.impactOccurred('light');
            
            score++;
            document.getElementById('score').innerText = score;

            // –ê–Ω–∏–º–∞—Ü–∏—è +1
            const float = document.createElement('div');
            float.className = 'floater';
            float.innerText = '+1';
            float.style.left = x + 'px';
            float.style.top = y + 'px';
            document.getElementById('screen-game').appendChild(float);
            setTimeout(() => float.remove(), 1000);

            el.remove();
        }

    </script>
</body>
</html>
